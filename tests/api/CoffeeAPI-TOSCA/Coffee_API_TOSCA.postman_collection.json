{
	"info": {
		"_postman_id": "coffee-api-tosca-collection",
		"name": "Coffee API - TOSCA Cloud Training",
		"description": "Complete test collection for Coffee API including positive and negative test cases",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "coffee-api-tester"
	},
	"item": [
		{
			"name": "Positive Test Cases",
			"item": [
				{
					"name": "GET_001 - Get All Coffees",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Validate status code",
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"// Validate response structure",
									"pm.test(\"Response is valid JSON array\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.be.an('array');",
									"});",
									"",
									"// Validate coffee objects structure",
									"pm.test(\"Each coffee has required fields\", function () {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.length > 0) {",
									"        const firstCoffee = jsonData[0];",
									"        pm.expect(firstCoffee).to.have.property('id');",
									"        pm.expect(firstCoffee).to.have.property('name');",
									"        pm.expect(firstCoffee).to.have.property('description');",
									"        pm.expect(firstCoffee.id).to.be.a('number');",
									"        pm.expect(firstCoffee.name).to.be.a('string').and.not.empty;",
									"        pm.expect(firstCoffee.description).to.be.a('string').and.not.empty;",
									"    }",
									"});",
									"",
									"// Capture IDs for subsequent tests",
									"pm.test(\"Capture coffee IDs\", function () {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.length > 0) {",
									"        pm.collectionVariables.set(\"captured_coffee_id\", jsonData[0].id);",
									"        const allIds = jsonData.map(coffee => coffee.id);",
									"        pm.collectionVariables.set(\"all_coffee_ids\", JSON.stringify(allIds));",
									"        console.log(\"Captured coffee IDs:\", allIds);",
									"    }",
									"});",
									"",
									"// Validate response time",
									"pm.test(\"Response time is under 5 seconds\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(5000);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "ServiceAccessKey",
								"value": "{{service_key}}",
								"description": "Service key for TOSCA training API"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/coffees",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"coffees"
							]
						},
						"description": "Retrieve complete list of all available coffees from the database"
					},
					"response": []
				},
				{
					"name": "GET_002 - Get Coffee by Valid ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Validate status code",
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"// Validate response structure",
									"pm.test(\"Response is valid JSON object\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.be.an('object');",
									"});",
									"",
									"// Validate required fields",
									"pm.test(\"Coffee object has required fields\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('id');",
									"    pm.expect(jsonData).to.have.property('name');",
									"    pm.expect(jsonData).to.have.property('description');",
									"});",
									"",
									"// Validate ID matches requested ID",
									"pm.test(\"Returned ID matches requested ID\", function () {",
									"    const jsonData = pm.response.json();",
									"    const requestedId = parseInt(pm.collectionVariables.get(\"captured_coffee_id\"));",
									"    pm.expect(jsonData.id).to.equal(requestedId);",
									"});",
									"",
									"// Validate response time",
									"pm.test(\"Response time is under 3 seconds\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(3000);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// Check if we have a captured ID",
									"const capturedId = pm.collectionVariables.get(\"captured_coffee_id\");",
									"if (!capturedId) {",
									"    console.log(\"No captured coffee ID found. Please run GET_001 first.\");",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "ServiceAccessKey",
								"value": "{{service_key}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/coffees/{{captured_coffee_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"coffees",
								"{{captured_coffee_id}}"
							]
						},
						"description": "Retrieve specific coffee details using a valid coffee ID from previous GET all coffees request"
					},
					"response": []
				},
				{
					"name": "PUT_001 - Update Existing Coffee (Expected to Fail)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// This test expects failure - UPDATE operations are not supported",
									"pm.test(\"Status code is 405 Method Not Allowed\", function () {",
									"    pm.response.to.have.status(405);",
									"});",
									"",
									"pm.test(\"Confirms API limitation - UPDATE not supported\", function () {",
									"    pm.expect(pm.response.status).to.equal(\"Method Not Allowed\");",
									"    console.log(\"✓ Confirmed: API does not support UPDATE operations\");",
									"});",
									"",
									"// Track attempted operation",
									"pm.collectionVariables.set(\"update_attempted\", \"true\");",
									"pm.collectionVariables.set(\"update_status\", \"405_method_not_allowed\");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "ServiceAccessKey",
								"value": "{{service_key}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"id\": {{captured_coffee_id}},\n  \"name\": \"Premium Colombian Blend - Updated\",\n  \"description\": \"Rich, full-bodied coffee with chocolate and caramel notes - Updated for testing purposes\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/coffees/{{captured_coffee_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"coffees",
								"{{captured_coffee_id}}"
							]
						},
						"description": "Attempt to update an existing coffee - API does not support this operation"
					},
					"response": []
				},
				{
					"name": "POST_001 - Create New Coffee - Artisan Espresso",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// API returns 200 for POST (not standard 201)",
									"pm.test(\"Status code is 200 (API specific behavior)\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"// Check if response contains created object or confirmation",
									"pm.test(\"Response indicates successful creation\", function () {",
									"    pm.expect(pm.response.code).to.equal(200);",
									"});",
									"",
									"// Try to capture created ID if available",
									"pm.test(\"Capture created ID if available\", function () {",
									"    try {",
									"        const jsonData = pm.response.json();",
									"        if (jsonData && jsonData.id) {",
									"            pm.collectionVariables.set(\"created_coffee_id_1\", jsonData.id);",
									"            console.log(\"Captured created coffee ID:\", jsonData.id);",
									"        } else {",
									"            // Generate mock ID for tracking",
									"            const mockId = \"mock_\" + Date.now() + \"_1\";",
									"            pm.collectionVariables.set(\"created_coffee_id_1\", mockId);",
									"            console.log(\"Generated mock ID for tracking:\", mockId);",
									"        }",
									"    } catch (e) {",
									"        // Generate mock ID if JSON parsing fails",
									"        const mockId = \"mock_\" + Date.now() + \"_1\";",
									"        pm.collectionVariables.set(\"created_coffee_id_1\", mockId);",
									"        console.log(\"Generated mock ID (JSON parse failed):\", mockId);",
									"    }",
									"});",
									"",
									"// Validate response time",
									"pm.test(\"Response time is under 5 seconds\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(5000);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "ServiceAccessKey",
								"value": "{{service_key}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Artisan Espresso Supreme\",\n  \"description\": \"Expertly crafted espresso blend with rich crema and bold flavor profile, perfect for morning energy boost\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/coffees",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"coffees"
							]
						},
						"description": "Create a new coffee entry with premium espresso details"
					},
					"response": []
				},
				{
					"name": "POST_002 - Create New Coffee - Midnight Roast",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// API returns 200 for POST",
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"// Capture created ID if available",
									"pm.test(\"Capture created ID if available\", function () {",
									"    try {",
									"        const jsonData = pm.response.json();",
									"        if (jsonData && jsonData.id) {",
									"            pm.collectionVariables.set(\"created_coffee_id_2\", jsonData.id);",
									"            console.log(\"Captured created coffee ID:\", jsonData.id);",
									"        } else {",
									"            const mockId = \"mock_\" + Date.now() + \"_2\";",
									"            pm.collectionVariables.set(\"created_coffee_id_2\", mockId);",
									"            console.log(\"Generated mock ID for tracking:\", mockId);",
									"        }",
									"    } catch (e) {",
									"        const mockId = \"mock_\" + Date.now() + \"_2\";",
									"        pm.collectionVariables.set(\"created_coffee_id_2\", mockId);",
									"        console.log(\"Generated mock ID (JSON parse failed):\", mockId);",
									"    }",
									"});",
									"",
									"pm.test(\"Response time is under 5 seconds\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(5000);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "ServiceAccessKey",
								"value": "{{service_key}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Midnight Roast Deluxe\",\n  \"description\": \"Dark roasted coffee beans with smoky undertones and hints of vanilla, ideal for late-night coding sessions\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/coffees",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"coffees"
							]
						},
						"description": "Create another new coffee entry with dark roast characteristics"
					},
					"response": []
				},
				{
					"name": "DELETE_001 - Delete Recently Created Coffee (Expected to Fail)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// This test expects failure - DELETE operations are not supported",
									"pm.test(\"Status code is 405 Method Not Allowed\", function () {",
									"    pm.response.to.have.status(405);",
									"});",
									"",
									"pm.test(\"Confirms API limitation - DELETE not supported\", function () {",
									"    pm.expect(pm.response.status).to.equal(\"Method Not Allowed\");",
									"    console.log(\"✓ Confirmed: API does not support DELETE operations\");",
									"});",
									"",
									"// Track attempted operation",
									"pm.collectionVariables.set(\"delete_attempted\", \"true\");",
									"pm.collectionVariables.set(\"delete_status\", \"405_method_not_allowed\");",
									"pm.collectionVariables.set(\"attempted_delete_id\", pm.collectionVariables.get(\"created_coffee_id_1\"));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "ServiceAccessKey",
								"value": "{{service_key}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/coffees/{{created_coffee_id_1}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"coffees",
								"{{created_coffee_id_1}}"
							]
						},
						"description": "Attempt to delete a recently created coffee - API does not support this operation"
					},
					"response": []
				},
				{
					"name": "GET_003 - Verify Coffee Still Exists After Delete Attempt",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Check if this is a mock ID or real ID",
									"const attemptedDeleteId = pm.collectionVariables.get(\"attempted_delete_id\");",
									"const isMockId = attemptedDeleteId && attemptedDeleteId.toString().startsWith(\"mock_\");",
									"",
									"if (isMockId) {",
									"    pm.test(\"Skip verification for mock ID\", function () {",
									"        console.log(\"✓ Skipped verification - mock ID used:\", attemptedDeleteId);",
									"        pm.expect(true).to.be.true; // Always pass",
									"    });",
									"} else {",
									"    // Real ID - check if coffee still exists",
									"    pm.test(\"Coffee should still exist (DELETE not supported)\", function () {",
									"        // Since DELETE returned 405, we expect the coffee to still exist",
									"        // But API might return 404 if ID was actually a mock or doesn't exist",
									"        const validStatusCodes = [200, 404];",
									"        pm.expect(validStatusCodes).to.include(pm.response.code);",
									"        ",
									"        if (pm.response.code === 200) {",
									"            console.log(\"✓ Confirmed: Coffee still exists (DELETE operation failed as expected)\");",
									"        } else if (pm.response.code === 404) {",
									"            console.log(\"✓ Coffee not found (may have been mock ID or already non-existent)\");",
									"        }",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "ServiceAccessKey",
								"value": "{{service_key}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/coffees/{{attempted_delete_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"coffees",
								"{{attempted_delete_id}}"
							]
						},
						"description": "Verify that coffee still exists after failed DELETE operation"
					},
					"response": []
				}
			],
			"description": "Positive test cases for Coffee API including expected failures for unsupported operations"
		},
		{
			"name": "Negative Test Cases",
			"item": [
				{
					"name": "NEG_001 - GET with Invalid Service Key",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Validate unauthorized access",
									"pm.test(\"Status code is 401 Unauthorized\", function () {",
									"    pm.response.to.have.status(401);",
									"});",
									"",
									"pm.test(\"Response indicates authentication failure\", function () {",
									"    pm.expect(pm.response.status).to.equal(\"Unauthorized\");",
									"});",
									"",
									"pm.test(\"No coffee data should be returned\", function () {",
									"    // Response should not contain valid coffee data",
									"    const responseText = pm.response.text();",
									"    pm.expect(responseText).to.not.include('\"id\"');",
									"});",
									"",
									"pm.test(\"Response time is under 2 seconds\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(2000);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "ServiceAccessKey",
								"value": "invalid_key_12345",
								"description": "Invalid service key for authentication testing"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/coffees",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"coffees"
							]
						},
						"description": "Test API authentication by providing an invalid service access key"
					},
					"response": []
				},
				{
					"name": "NEG_002 - POST with Missing Required Name Field",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Validate bad request response",
									"pm.test(\"Status code is 400 Bad Request\", function () {",
									"    pm.response.to.have.status(400);",
									"});",
									"",
									"pm.test(\"Response indicates missing required field\", function () {",
									"    pm.expect(pm.response.status).to.equal(\"Bad Request\");",
									"});",
									"",
									"pm.test(\"No coffee should be created\", function () {",
									"    // Verify that creation failed",
									"    pm.expect(pm.response.code).to.not.equal(200);",
									"});",
									"",
									"pm.test(\"Response time is under 2 seconds\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(2000);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "ServiceAccessKey",
								"value": "{{service_key}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"description\": \"Coffee without name field - should trigger validation error\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/v1/coffees",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"coffees"
							]
						},
						"description": "Attempt to create coffee without providing the required 'name' field"
					},
					"response": []
				},
				{
					"name": "NEG_003 - GET Non-existent Coffee ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Validate not found response",
									"pm.test(\"Status code is 404 Not Found\", function () {",
									"    pm.response.to.have.status(404);",
									"});",
									"",
									"pm.test(\"Response indicates resource not found\", function () {",
									"    pm.expect(pm.response.status).to.equal(\"Not Found\");",
									"});",
									"",
									"pm.test(\"No coffee data should be returned\", function () {",
									"    // Response should not contain valid coffee data",
									"    const responseText = pm.response.text();",
									"    pm.expect(responseText).to.not.include('\"name\"');",
									"    pm.expect(responseText).to.not.include('\"description\"');",
									"});",
									"",
									"pm.test(\"Response time is under 2 seconds\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(2000);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "ServiceAccessKey",
								"value": "{{service_key}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/coffees/99999",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"coffees",
								"99999"
							]
						},
						"description": "Attempt to retrieve coffee using an ID that does not exist in the database"
					},
					"response": []
				}
			],
			"description": "Negative test cases to validate error handling and security controls"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Global pre-request setup",
					"console.log(\"Executing request:\", pm.info.requestName);",
					"console.log(\"Base URL:\", pm.collectionVariables.get(\"base_url\"));",
					"",
					"// Validate required variables",
					"const serviceKey = pm.collectionVariables.get(\"service_key\");",
					"const baseUrl = pm.collectionVariables.get(\"base_url\");",
					"",
					"if (!serviceKey || serviceKey === \"YOUR_SERVICE_KEY_HERE\") {",
					"    console.warn(\"⚠️ Service key not configured. Please set 'service_key' collection variable.\");",
					"}",
					"",
					"if (!baseUrl) {",
					"    console.warn(\"⚠️ Base URL not configured. Please set 'base_url' collection variable.\");",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Global post-request logging",
					"console.log(\"Completed request:\", pm.info.requestName);",
					"console.log(\"Status:\", pm.response.code, pm.response.status);",
					"console.log(\"Response time:\", pm.response.responseTime + \"ms\");",
					"",
					"// Log any errors for debugging",
					"if (pm.response.code >= 400) {",
					"    console.log(\"Error response body:\", pm.response.text());",
					"}"
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "https://webservice.toscacloud.com",
			"type": "string",
			"description": "Base URL for TOSCA Cloud Training API"
		},
		{
			"key": "service_key",
			"value": "YOUR_SERVICE_KEY_HERE",
			"type": "string",
			"description": "Service Access Key obtained from https://webservice.toscacloud.com/training/"
		},
		{
			"key": "captured_coffee_id",
			"value": "",
			"type": "string",
			"description": "Coffee ID captured from GET all coffees request"
		},
		{
			"key": "all_coffee_ids",
			"value": "",
			"type": "string",
			"description": "JSON array of all coffee IDs"
		},
		{
			"key": "created_coffee_id_1",
			"value": "",
			"type": "string",
			"description": "ID of first created coffee (or mock ID)"
		},
		{
			"key": "created_coffee_id_2",
			"value": "",
			"type": "string",
			"description": "ID of second created coffee (or mock ID)"
		},
		{
			"key": "attempted_delete_id",
			"value": "",
			"type": "string",
			"description": "ID that was attempted to be deleted"
		},
		{
			"key": "update_attempted",
			"value": "",
			"type": "string",
			"description": "Flag indicating if update was attempted"
		},
		{
			"key": "update_status",
			"value": "",
			"type": "string",
			"description": "Status of update attempt"
		},
		{
			"key": "delete_attempted",
			"value": "",
			"type": "string",
			"description": "Flag indicating if delete was attempted"
		},
		{
			"key": "delete_status",
			"value": "",
			"type": "string",
			"description": "Status of delete attempt"
		}
	]
}